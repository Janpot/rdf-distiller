<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: spira-README
  
    &mdash; Web portal for RDF.rb.
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: spira-README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Spira</h1>

<p>It's time to breathe life into your linked data.</p>

<hr />

<h2>Synopsis</h2>

<p>Spira is a framework for using the information in <a href="http://rdf.rubyforge.org">RDF.rb</a> repositories as model
objects.  It gives you the ability to work in a resource-oriented way without
losing access to statement-oriented nature of linked data, if you so choose.
It can be used either to access existing RDF data in a resource-oriented way,
or to create a new store of RDF data based on simple defaults.</p>

<p>An introductory blog post is at <a href="http://blog.datagraph.org/2010/05/spira">http://blog.datagraph.org/2010/05/spira</a></p>

<p>A changelog is available in the <a href="file.CHANGES.html" title="CHANGES">CHANGES</a> file.</p>

<h3>Example</h3>

<pre class="code"><span class='kw'>class</span> <span class='const'>Person</span>

  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>

  <span class='id base_uri'>base_uri</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://example.org/example/people</span><span class='tstring_end'>&quot;</span></span>

  <span class='id property'>property</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>FOAF</span><span class='period'>.</span><span class='id name'>name</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>String</span>
  <span class='id property'>property</span> <span class='symbol'>:age</span><span class='comma'>,</span>  <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>FOAF</span><span class='period'>.</span><span class='id age'>age</span><span class='comma'>,</span>  <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>Integer</span>

<span class='kw'>end</span>

<span class='id bob'>bob</span> <span class='op'>=</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://example.org/people/bob</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id as'>as</span><span class='lparen'>(</span><span class='const'>Person</span><span class='rparen'>)</span>
<span class='id bob'>bob</span><span class='period'>.</span><span class='id age'>age</span>  <span class='op'>=</span> <span class='int'>15</span>
<span class='id bob'>bob</span><span class='period'>.</span><span class='id name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob Smith</span><span class='tstring_end'>&quot;</span></span>
<span class='id bob'>bob</span><span class='period'>.</span><span class='id save!'>save!</span>

<span class='id bob'>bob</span><span class='period'>.</span><span class='id each_statement'>each_statement</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id s'>s</span><span class='op'>|</span> <span class='id puts'>puts</span> <span class='id s'>s</span><span class='rbrace'>}</span>
<span class='comment'>#=&gt; RDF::Statement:0x80abb80c(&lt;http://example.org/example/people/bob&gt; &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Bob Smith&quot; .)
</span><span class='comment'>#=&gt; RDF::Statement:0x80abb8fc(&lt;http://example.org/example/people/bob&gt; &lt;http://xmlns.com/foaf/0.1/age&gt; &quot;15&quot;^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt; .)
</span></pre>

<h3>Features</h3>

<ul>
<li>Extensible validations system</li>
<li>Extensible types system</li>
<li>Easy to use multiple data sources</li>
<li>Easy to adapt models to existing data</li>
<li>Open-world semantics</li>
<li>Objects are still RDF.rb-compatible enumerable objects</li>
<li>No need to put everything about an object into Spira</li>
<li>Easy to use a resource as multiple models</li>
</ul>


<h2>Getting Started</h2>

<p>The easiest way to work with Spira is to install it via Rubygems:</p>

<pre class="code">$ sudo gem install spira
</pre>

<p>Downloads will be available on the github project page, as well as on Rubyforge.</p>

<h2>Defining Model Classes</h2>

<p>To use Spira, define model classes for your RDF data.  Spira classes include
RDF, and thus have access to all <code>RDF::Vocabulary</code> classes and <code>RDF::URI</code>
without the <code>RDF::</code> prefix.  For example:</p>

<pre class="code"><span class='id require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>spira</span><span class='tstring_end'>'</span></span>

<span class='kw'>class</span> <span class='const'>CD</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id base_uri'>base_uri</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/cds</span><span class='tstring_end'>'</span></span>
  <span class='id property'>property</span> <span class='symbol'>:name</span><span class='comma'>,</span>   <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>DC</span><span class='period'>.</span><span class='id title'>title</span><span class='comma'>,</span>   <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>XSD</span><span class='period'>.</span><span class='id string'>string</span>
  <span class='id property'>property</span> <span class='symbol'>:artist</span><span class='comma'>,</span> <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/vocab/artist</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='symbol'>:artist</span>
<span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>Artist</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id base_uri'>base_uri</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/artists</span><span class='tstring_end'>'</span></span>
  <span class='id property'>property</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>DC</span><span class='period'>.</span><span class='id title'>title</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>XSD</span><span class='period'>.</span><span class='id string'>string</span>
  <span class='id has_many'>has_many</span> <span class='symbol'>:cds</span><span class='comma'>,</span>  <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/vocab/published_cd</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>XSD</span><span class='period'>.</span><span class='id string'>string</span>
<span class='kw'>end</span>
</pre>

<p>Then use your model classes, in a way more or less similar to any number of ORMs:</p>

<pre class="code">cd = CD.for(&quot;queens-greatest-hits&quot;)
cd.name = &quot;Queen's greatest hits&quot;
artist = Artist.for(&quot;queen&quot;)
artist.name = &quot;Queen&quot;

cd.artist = artist
cd.save!
artist.cds = [cd]
artist.save!

queen = Artist.for('queen')
hits = CD.for 'queens-greatest-hits'
hits.artist == artist == queen
</pre>

<h3>URIs and Blank Nodes</h3>

<p>Spira instances have a subject, which is either a URI or a blank node.</p>

<p>A class with a base URI can instantiate with a string (or anything, via to_s),
and it will have a URI representation:</p>

<pre class="code"><span class='const'>Artist</span><span class='period'>.</span><span class='id for'>for</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>queen</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
</pre>

<p>However, a class is not required to have a base URI, and even if it does, it
can always access classes with a full URI:</p>

<pre class="code"><span class='id nk'>nk</span> <span class='op'>=</span> <span class='const'>Artist</span><span class='period'>.</span><span class='id for'>for</span><span class='lparen'>(</span><span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/my-hidden-cds/new-kids</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
</pre>

<p>If you have a URI that you would like to look at as a Spira resource, you can instantiate it from the URI:</p>

<pre class="code"><span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/my-hidden-cds/new-kids</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id as'>as</span><span class='lparen'>(</span><span class='const'>Artist</span><span class='rparen'>)</span>
<span class='comment'># =&gt; &lt;Artist @subject=http://example.org/my-hidden-cds/new-kids&gt;
</span></pre>

<p>Any call to 'for' with a valid identifier will always return an object with nil
fields.  It's a way of looking at a given resource, not a closed-world mapping
to one.</p>

<p>You can also use blank nodes more or less as you would a URI:</p>

<pre class="code"><span class='id remix_artist'>remix_artist</span> <span class='op'>=</span> <span class='const'>Artist</span><span class='period'>.</span><span class='id for'>for</span><span class='lparen'>(</span><span class='const'>RDF</span><span class='op'>::</span><span class='const'>Node</span><span class='period'>.</span><span class='id new'>new</span><span class='rparen'>)</span>
<span class='comment'># =&gt; &lt;Artist @subject=#&lt;RDF::Node:0xd1d314(_:g13751060)&gt;&gt;
</span><span class='const'>RDF</span><span class='op'>::</span><span class='const'>Node</span><span class='period'>.</span><span class='id new'>new</span><span class='period'>.</span><span class='id as'>as</span><span class='lparen'>(</span><span class='const'>Artist</span><span class='rparen'>)</span>
<span class='comment'># =&gt; &lt;Artist @subject=#&lt;RDF::Node:0xd1d314(_:g13751040)&gt;&gt;
</span></pre>

<p>Finally, you can create an instance of a Spira projection with #new, and you'll
get an instance with a shiny new blank node subject:</p>

<pre class="code"><span class='id formerly_known_as_prince'>formerly_known_as_prince</span> <span class='op'>=</span> <span class='const'>Artist</span><span class='period'>.</span><span class='id new'>new</span>
<span class='comment'># =&gt; &lt;Artist @subject=#&lt;RDF::Node:0xd1d314(_:g13747140)&gt;&gt;
</span></pre>

<h3>Class Options</h3>

<p>A number of options are available for Spira classes.</p>

<h4>base_uri</h4>

<p>A class with a <code>base_uri</code> set (either an <code>RDF::URI</code> or a <code>String</code>) will
use that URI as a base URI for non-absolute <code>for</code> calls.</p>

<p>Example</p>

<pre class="code"><span class='const'>CD</span><span class='period'>.</span><span class='id for'>for</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>queens-greatest-hits</span><span class='tstring_end'>'</span></span> <span class='comment'># is the same as...
</span><span class='const'>CD</span><span class='period'>.</span><span class='id for'>for</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/cds/queens-greatest-hits</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
</pre>

<h4>type</h4>

<p>A class with a <code>type</code> set is assigned an <code>RDF.type</code> on creation and saving.</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>Album</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id type'>type</span> <span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/types/album</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id property'>property</span> <span class='symbol'>:name</span><span class='comma'>,</span>   <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>DC</span><span class='period'>.</span><span class='id title'>title</span>
<span class='kw'>end</span>

<span class='id rolling_stones'>rolling_stones</span> <span class='op'>=</span> <span class='const'>Album</span><span class='period'>.</span><span class='id for'>for</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/cds/rolling-stones-hits</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># See RDF.rb at http://rdf.rubyforge.org/RDF/Enumerable.html for more information about #has_predicate?
</span><span class='id rolling_stones'>rolling_stones</span><span class='period'>.</span><span class='id has_predicate?'>has_predicate?</span><span class='lparen'>(</span><span class='const'>RDF</span><span class='period'>.</span><span class='id type'>type</span><span class='rparen'>)</span> <span class='comment'>#=&gt; true
</span><span class='const'>Album</span><span class='period'>.</span><span class='id type'>type</span> <span class='comment'>#=&gt; RDF::URI('http://example.org/types/album')
</span></pre>

<p>In addition, one can count the members of a class with a <code>type</code> defined:</p>

<pre class="code"><span class='const'>Album</span><span class='period'>.</span><span class='id count'>count</span>  <span class='comment'>#=&gt; 1 
</span></pre>

<h4>property</h4>

<p>A class declares property members with the <code>property</code> function.  See <code>Property Options</code> for more information.</p>

<h4>has_many</h4>

<p>A class declares list members with the <code>has_many</code> function.  See <code>Property Options</code> for more information.</p>

<h4>default_vocabulary</h4>

<p>A class with a <code>default_vocabulary</code> set will transparently create predicates for defined properties:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>Song</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id default_vocabulary'>default_vocabulary</span> <span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/vocab</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id base_uri'>base_uri</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/songs</span><span class='tstring_end'>'</span></span>
  <span class='id property'>property</span> <span class='symbol'>:title</span>
  <span class='id property'>property</span> <span class='symbol'>:author</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='symbol'>:artist</span>
<span class='kw'>end</span>

<span class='id dancing_queen'>dancing_queen</span> <span class='op'>=</span> <span class='const'>Song</span><span class='period'>.</span><span class='id for'>for</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>dancing-queen</span><span class='tstring_end'>'</span></span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Dancing Queen</span><span class='tstring_end'>&quot;</span></span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span> <span class='op'>=</span> <span class='id abba'>abba</span>
<span class='comment'># See RDF::Enumerable for #has_predicate?
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id has_predicate?'>has_predicate?</span><span class='lparen'>(</span><span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/vocab/title</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rparen'>)</span>  <span class='comment'>#=&gt; true
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id has_predicate?'>has_predicate?</span><span class='lparen'>(</span><span class='const'>RDF</span><span class='op'>::</span><span class='const'>URI</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://example.org/vocab/artist</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='comment'>#=&gt; true
</span></pre>

<h4>default_source</h4>

<p>Provides this class with a default repository to use instead of the <code>:default</code>
repository if one is not set.</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>Song</span>
  <span class='id default_source'>default_source</span> <span class='symbol'>:songs</span>
<span class='kw'>end</span>
</pre>

<p>See 'Defining Repositories' for more information.</p>

<h4>validate</h4>

<p>Provides the name of a function which does some sort of validation.  See
'Validations' for more information.</p>

<h3>Property Options</h3>

<p>Spira classes can have properties that are either singular or a list.  For a
list, define the property with <code>has_many</code>, for a property with a single item,
use <code>property</code>.  The semantics are otherwise the same.  A <code>has_many</code> property
will always return a list, including an empty list for no value.  All options
for <code>property</code> work for <code>has_many</code>.</p>

<pre class="code"><span class='id property'>property</span> <span class='symbol'>:artist</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='symbol'>:artist</span>    <span class='comment'>#=&gt; cd.artist returns a single value
</span><span class='id has_many'>has_many</span> <span class='symbol'>:cds</span><span class='comma'>,</span>    <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='symbol'>:cd</span>        <span class='comment'>#=&gt; artist.cds returns an array
</span></pre>

<p>Property always takes a symbol name as a name, and a variable list of options.  The supported options are:</p>

<ul>
<li><code>:type</code>: The type for this property.  This can be a Ruby base class, an
RDF::XSD entry, or another Spira model class, referenced as a symbol.  See
<strong>Types</strong> below.  Default: <code>Any</code></li>
<li><code>:predicate</code>: The predicate to use for this type.  This can be any RDF URI.
This option is required unless the <code>default_vocabulary</code> has been used.</li>
</ul>


<h3>Types</h3>

<p>A property's type can be either a class which includes Spira::Type or a
reference to another Spira model class, given as a symbol.</p>

<h4>Relations</h4>

<p>If the <code>:type</code> of a spira class is the name of another Spira class as a symbol,
such as <code>:artist</code> for <code>Artist</code>, Spira will attempt to load the referenced
object when the appropriate property is accessed.</p>

<p>In the RDF store, this will be represented by the URI of the referenced object.</p>

<h4>Type Classes</h4>

<p>A type class includes Spira::Type, and can implement serialization and
deserialization functions, and register aliases to themselves if their datatype
is usually expressed as a URI.  Here is the built-in Spira Integer class:</p>

<pre class="code"><span class='kw'>module</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Types</span>
  <span class='kw'>class</span> <span class='const'>Integer</span>

    <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Type</span>

    <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id unserialize'>unserialize</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
      <span class='id value'>value</span><span class='period'>.</span><span class='id object'>object</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id serialize'>serialize</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
      <span class='const'>RDF</span><span class='op'>::</span><span class='const'>Literal</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id register_alias'>register_alias</span> <span class='const'>XSD</span><span class='period'>.</span><span class='id integer'>integer</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>

<p>Classes can now use this particular type like so:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>Test</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id property'>property</span> <span class='symbol'>:test1</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>Integer</span>
  <span class='id property'>property</span> <span class='symbol'>:test2</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>XSD</span><span class='period'>.</span><span class='id integer'>integer</span>
<span class='kw'>end</span>
</pre>

<p>Spira classes include the Spira::Types namespace, where several default types
are implemented:</p>

<ul>
<li><code>Integer</code></li>
<li><code>Float</code></li>
<li><code>Boolean</code></li>
<li><code>String</code></li>
<li><code>Any</code></li>
</ul>


<p>The default type for a Spira property is <code>Spira::Types::Any</code>, which uses
<code>RDF::Literal</code>'s automatic boxing/unboxing of XSD types as best it can.  See
<code>[RDF::Literal](http://rdf.rubyforge.org/RDF/Literal.html)</code> for more information.</p>

<p>You can implement your own types as well.  Your class' serialize method should
turn an RDF::Value into a ruby object, and vice versa.</p>

<pre class="code">module MyModule
  class MyType
    include Spira::Type
    def self.serialize(value)
      ...
    end

    def self.unserialize(value)
      ...
    end
  end
end

class MyClass
  include Spira::Resource
  property :property1, :type =&gt; MyModule::MyType
end
</pre>

<h2>Defining Repositories</h2>

<p>You can define multiple repositories with Spira, and use more than one at a time:</p>

<pre class="code">require 'rdf/ntriples'
require 'rdf/sesame'
Spira.add_repository! :cds,    RDF::Sesame::Repository.new 'some_server'
Spira.add_repository! :albums, RDF::Repository.load('some_file.nt')

CD.repository = :cds
Album.repository = :albums
</pre>

<p>Objects can reference each other cross-repository.</p>

<p>If no repository has been specified, the <code>:default</code> repository will be used.</p>

<pre class="code"><span class='id repo'>repo</span> <span class='op'>=</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>Repository</span><span class='period'>.</span><span class='id new'>new</span>
<span class='const'>Spira</span><span class='period'>.</span><span class='id add_repository!'>add_repository!</span> <span class='symbol'>:default</span><span class='comma'>,</span> <span class='id repo'>repo</span>
<span class='const'>Artist</span><span class='period'>.</span><span class='id repository'>repository</span> <span class='op'>==</span> <span class='id repo'>repo</span> <span class='comment'>#=&gt; true
</span></pre>

<p>Classes can specify a default repository to use other than <code>:default</code> with the
<code>default_source</code> function:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>Song</span>
  <span class='id default_source'>default_source</span> <span class='symbol'>:songs</span>
<span class='kw'>end</span>

<span class='const'>Song</span><span class='period'>.</span><span class='id repository'>repository</span> <span class='comment'>#=&gt; nil, won't use :default
</span></pre>

<h2>Validations</h2>

<p>You may declare any number of validation functions with the <code>validate</code> function.
Before saving, each referenced validation will be run, and the instance's
<span class='object_link'><a href="Spira/Errors.html" title="Spira::Errors (class)">Spira::Errors</a></span> object will be populated with any errors.  You can use the
built in <code>assert</code> and assert helpers such as <code>assert_set</code> and
<code>asssert_numeric</code>.</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>CD</span>
  <span class='id validate'>validate</span> <span class='symbol'>:is_real_music</span>
  <span class='kw'>def</span> <span class='id is_real_music'>is_real_music</span>
    <span class='id assert'>assert</span><span class='lparen'>(</span><span class='id artist'>artist</span><span class='period'>.</span><span class='id name'>name</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nickelback</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:artist</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cannot be Nickelback</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id validate'>validate</span> <span class='symbol'>:track_count_numeric</span>
  <span class='kw'>def</span> <span class='id track_count_numeric'>track_count_numeric</span>
    <span class='id assert_numeric'>assert_numeric</span><span class='lparen'>(</span><span class='id track_count'>track_count</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span> <span class='op'>=</span> <span class='id nickelback'>nickelback</span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id save!'>save!</span>  <span class='comment'>#=&gt; ValidationError
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id errors'>errors</span><span class='period'>.</span><span class='id each'>each</span> <span class='comment'>#=&gt; [&quot;artist cannot be Nickelback&quot;]
</span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span> <span class='op'>=</span> <span class='id abba'>abba</span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id save!'>save!</span>  <span class='comment'>#=&gt; true
</span></pre>

<h2>Hooks</h2>

<p>Spira supports <code>before_create</code>, <code>after_create</code>, <code>after_update</code>, <code>before_save</code>,
<code>after_save</code>, and <code>before_destroy</code> hooks:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>CD</span>
  <span class='kw'>def</span> <span class='id before_save'>before_save</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id publisher'>publisher</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>No publisher set</span><span class='tstring_end'>'</span></span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id publisher'>publisher</span><span class='period'>.</span><span class='id nil?'>nil?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>

<p>The <code>after_update</code> hook only fires on the <code>update</code> method, not simple property
accessors (to allow you to easily set properties in these without going into a
recursive loop):</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>CD</span>
  <span class='kw'>def</span> <span class='id after_update'>after_update</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id artist'>artist</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Queen</span><span class='tstring_end'>'</span></span> <span class='comment'># every artist should be Queen!
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># ...snip ...
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span>
<span class='comment'>#=&gt; &quot;ABBA&quot;
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Dancing Queen</span><span class='tstring_end'>&quot;</span></span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span>
<span class='comment'>#=&gt; &quot;ABBA&quot;
</span><span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id update'>update</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Dancing Queen</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id dancing_queen'>dancing_queen</span><span class='period'>.</span><span class='id artist'>artist</span>
<span class='comment'>#=&gt; &quot;Queen&quot;
</span></pre>

<h2>Inheritance</h2>

<p>You can extend Spira resources without a problem:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>BoxedSet</span> <span class='op'>&lt;</span> <span class='const'>CD</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id property'>property</span> <span class='id cd_count'>cd_count</span><span class='comma'>,</span> <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>CD</span><span class='period'>.</span><span class='id count'>count</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='const'>Integer</span>
<span class='kw'>end</span>
</pre>

<p>You can also make Spira modules and include them into other classes:</p>

<pre class="code"><span class='kw'>module</span> <span class='const'>Media</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id property'>property</span> <span class='symbol'>:format</span><span class='comma'>,</span> <span class='symbol'>:predicate</span> <span class='op'>=&gt;</span> <span class='const'>Media</span><span class='period'>.</span><span class='id format'>format</span>
<span class='kw'>end</span>

<span class='kw'>class</span> <span class='const'>CD</span>
  <span class='id include'>include</span> <span class='const'>Spira</span><span class='op'>::</span><span class='const'>Resource</span>
  <span class='id include'>include</span> <span class='const'>Media</span>
<span class='kw'>end</span>
</pre>

<h2>Using Model Objects as RDF.rb Objects</h2>

<p>All model objects are fully-functional as <code>RDF::Enumerable</code>, <code>RDF::Queryable</code>,
and <code>RDF::Mutable</code>.  This lets you manipulate objects on the RDF statement
level.  You can also access attributes that are not defined as properties.</p>

<h2>Support</h2>

<p>There are a number of ways to ask for help.  In declining order of preference:</p>

<ul>
<li>Fork the project and write a failing test, or a pending test for a feature request</li>
<li>Ask on the <a href="http://lists.w3.org/Archives/Public/public-rdf-ruby/">public-rdf-ruby w3c mailing list</a></li>
<li>You can post issues to the Github issue queue</li>
<li>(there might one day be a google group or other such support channel, but not yet)</li>
</ul>


<h2>Authors, Development, and License</h2>

<h4>Authors</h4>

<ul>
<li>Ben Lavender <a href="&#109;&#x61;&#x69;&#x6c;&#116;&#111;&#58;&#x62;&#108;&#97;&#x76;&#101;&#110;&#100;&#x65;&#x72;&#64;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#46;&#99;&#x6f;&#109;">&#98;&#x6c;&#97;&#x76;&#x65;&#110;&#100;&#101;&#x72;&#64;&#103;&#109;&#x61;&#105;&#108;&#46;&#99;&#111;&#x6d;</a></li>
</ul>


<h4>'License'</h4>

<p>Spira is free and unemcumbered software released into the public
domain.  For more information, see the included UNLICENSE file.</p>

<h4>Contributing</h4>

<p>Fork it on Github and go.  Please make sure you're kosher with the UNLICENSE
file before contributing.</p></div></div>
    
    <div id="footer">
  Generated on Mon Aug 22 16:49:23 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>