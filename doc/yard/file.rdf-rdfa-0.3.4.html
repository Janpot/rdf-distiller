<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: rdf-rdfa-0.3.4
  
    &mdash; Web portal for RDF.rb.
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: rdf-rdfa-0.3.4</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>RDF::RDFa reader/writer</h1>

<p><a href="http://www.w3.org/TR/2011/WD-rdfa-core-20110331/" title="RDFa 1.1 Core">RDFa</a> parser for RDF.rb.</p>

<h2>DESCRIPTION</h2>

<p>RDF::RDFa is an RDFa reader and writer for Ruby using the <a href="http://rdf.rubyforge.org/">RDF.rb</a> library suite.</p>

<h2>FEATURES</h2>

<p>RDF::RDFa parses <a href="http://www.w3.org/TR/2011/WD-rdfa-core-20110331/" title="RDFa 1.1 Core">RDFa</a> into statements or triples.</p>

<ul>
<li>Fully compliant RDFa 1.1 parser.</li>
<li>Template-based Writer to generate XHTML+RDFa.

<ul>
<li>Writer uses user-replacable <a href="http://haml-lang.com/">Haml</a>-based templates to generate RDFa.</li>
</ul>
</li>
<li>Uses Nokogiri for parsing HTML/SVG</li>
<li><a href="http://rdfa.digitalbazaar.com/test-suite/" title="RDFa test suite">RDFa tests</a> use SPARQL for most tests due to Rasqal limitations. Other tests compare directly against N-triples.</li>
</ul>


<p>Install with 'gem install rdf-rdfa'</p>

<h2>Usage</h2>

<h3>Reading RDF data in the RDFa format</h3>

<pre class="code"><span class='const'>RDF</span><span class='op'>::</span><span class='const'>RDFa</span><span class='op'>::</span><span class='const'>Reader</span><span class='period'>.</span><span class='id open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>etc/foaf.html</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id reader'>reader</span><span class='op'>|</span>
  <span class='id reader'>reader</span><span class='period'>.</span><span class='id each_statement'>each_statement</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id statement'>statement</span><span class='op'>|</span>
    <span class='id puts'>puts</span> <span class='id statement'>statement</span><span class='period'>.</span><span class='id inspect'>inspect</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>

<h3>Writing RDF data using the XHTML+RDFa format</h3>

<pre class="code"><span class='id require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rdf/rdfa</span><span class='tstring_end'>'</span></span>

<span class='const'>RDF</span><span class='op'>::</span><span class='const'>RDFa</span><span class='op'>::</span><span class='const'>Writer</span><span class='period'>.</span><span class='id open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello.html</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id writer'>writer</span><span class='op'>|</span>
  <span class='id writer'>writer</span> <span class='op'>&lt;&lt;</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>Graph</span><span class='period'>.</span><span class='id new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id graph'>graph</span><span class='op'>|</span>
    <span class='id graph'>graph</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='symbol'>:hello</span><span class='comma'>,</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>DC</span><span class='period'>.</span><span class='id title'>title</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world!</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>

<p>Note that prefixes may be chained between Reader and Writer, so that the Writer will
use the same prefix definitions found during parsing:</p>

<pre class="code"><span class='id prefixes'>prefixes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='id graph'>graph</span> <span class='op'>=</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>Graph</span><span class='period'>.</span><span class='id load'>load</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>etc/foaf.html</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:prefixes</span> <span class='op'>=&gt;</span> <span class='id prefixes'>prefixes</span><span class='rparen'>)</span>
<span class='id puts'>puts</span> <span class='id graph'>graph</span><span class='period'>.</span><span class='id dump'>dump</span><span class='lparen'>(</span><span class='symbol'>:rdfa</span><span class='comma'>,</span> <span class='symbol'>:prefixes</span> <span class='op'>=&gt;</span> <span class='id prefixes'>prefixes</span><span class='rparen'>)</span>
</pre>

<h3>Template-based Writer</h3>

<p>The RDFa writer uses <a href="http://haml-lang.com/">Haml</a> templates for code generation. This allows fully
customizable RDFa output in a variety of host languages.
The <a href="<span class='object_link'><a href="RDF/RDFa/Writer.html#DEFAULT_HAML-constant" title="RDF::RDFa::Writer::DEFAULT_HAML (constant)">RDF::RDFa::Writer::DEFAULT_HAML</a></span>">default template</a> generates human readable HTML5
output. A <a href="<span class='object_link'><a href="RDF/RDFa/Writer.html#MIN_HAML-constant" title="RDF::RDFa::Writer::MIN_HAML (constant)">RDF::RDFa::Writer::MIN_HAML</a></span>">minimal template</a> generates HTML, which is not
intended for human consumption.</p>

<p>To specify an alternative Haml template, consider the following:</p>

<pre class="code"><span class='id require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rdf/rdfa</span><span class='tstring_end'>'</span></span>

<span class='const'>RDF</span><span class='op'>::</span><span class='const'>RDFa</span><span class='op'>::</span><span class='const'>Writer</span><span class='period'>.</span><span class='id buffer'>buffer</span><span class='lparen'>(</span><span class='symbol'>:haml</span> <span class='op'>=&gt;</span> <span class='const'>RDF</span><span class='op'>::</span><span class='const'>RDFa</span><span class='op'>::</span><span class='const'>Writer</span><span class='op'>::</span><span class='const'>MIN_HAML</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='id graph'>graph</span>
</pre>

<p>The template hash defines four Haml templates:</p>

<ul>
<li><p><em>doc</em>: Document Template, takes an ordered list of <em>subject</em>s and yields each one to be rendered.
Described further in <span class='object_link'><a href="RDF/RDFa/Writer.html#render_document-instance_method" title="RDF::RDFa::Writer#render_document (method)">RDF::RDFa::Writer#render_document</a></span>.</p>

<pre class="code">!!! XML
!!! 5
%html{:xmlns =&gt; &quot;http://www.w3.org/1999/xhtml&quot;, :lang =&gt; lang, :profile =&gt; profile, :prefix =&gt; prefix}
  - if base || title
    %head
      - if base
        %base{:href =&gt; base}
      - if title
        %title= title
  %body
    - subjects.each do |subject|
      != yield(subject)
</pre>

<p>This template takes locals <em>lang</em>, <em>profile</em>, <em>prefix</em>, <em>base</em>, <em>title</em> in addition to <em>subjects</em>
to create output similar to the following:</p>

<pre class="code">&lt;!DOCTYPE html&gt;
&lt;html prefix='xhv: http://www.w3.org/1999/xhtml/vocab#' xmlns='http://www.w3.org/1999/xhtml'&gt;
  &lt;head&gt;
    &lt;base href=&quot;http://example/&quot;&gt;
    &lt;title&gt;Document Title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    ...
  &lt;/body&gt;
&lt;/html&gt;
</pre>

<p>Options passed to the Writer are used to supply <em>lang</em>, <em>profile</em> and <em>base</em> locals.
<em>prefix</em> is generated based upon prefixes found from default or supplied profiles, as well
as those provided by a previous Reader. <em>title</em> is taken from the first top-level subject
having an appropriate title property (as defined by the <em>heading</em>predicates_ option).</p></li>
<li><p><em>subject</em>: Subject Template, take a <em>subject</em> and an order list of <em>predicate</em>s and yields
each <em>predicate</em> to be rendered. Described further in <span class='object_link'><a href="RDF/RDFa/Writer.html#render_subject-instance_method" title="RDF::RDFa::Writer#render_subject (method)">RDF::RDFa::Writer#render_subject</a></span>.</p>

<pre class="code">- if element == :li
  %li{:about =&gt; get_curie(subject), :typeof =&gt; typeof}
    - if typeof
      %span.type!= typeof
    - predicates.each do |predicate|
      != yield(predicate)
- elsif rel &amp;&amp; typeof
  %div{:rel =&gt; get_curie(rel)}
    %div{:about =&gt; get_curie(subject), :typeof =&gt; typeof}
      %span.type!= typeof
      - predicates.each do |predicate|
        != yield(predicate)
- elsif rel
  %div{:rel =&gt; get_curie(rel), :resource =&gt; get_curie(subject)}
    - predicates.each do |predicate|
      != yield(predicate)
- else
  %div{:about =&gt; get_curie(subject), :typeof =&gt; typeof}
    - if typeof
      %span.type!= typeof
    - predicates.each do |predicate|
      != yield(predicate)
</pre>

<p>The template takes locals <em>rel</em> and <em>typeof</em> in addition to <em>predicates</em> and <em>subject</em> to
create output similar to the following:</p>

<pre class="code">&lt;div about=&quot;http://example/&quot;&gt;
  ...
&lt;/div&gt;
</pre>

<p>Note that if <em>typeof</em> is defined, in this template, it will generate a textual description.</p></li>
<li><p><em>property_value</em>: Property Value Template, used for predicates having a single value; takes
a <em>predicate</em>, and a single-valued Array of <em>objects</em>. Described further in <span class='object_link'><a href="RDF/RDFa/Writer.html#render_property-instance_method" title="RDF::RDFa::Writer#render_property (method)">RDF::RDFa::Writer#render_property</a></span>.</p>

<pre class="code">- object = objects.first
- if heading_predicates.include?(predicate) &amp;&amp; object.literal?
  %h1{:property =&gt; get_curie(predicate), :content =&gt; get_content(object), :lang =&gt; get_lang(object), :datatype =&gt; get_dt_curie(object)}&amp;= get_value(object)
- else
  %div.property
    %span.label
      = get_predicate_name(predicate)
    - if res = yield(object)
      != res
    - elsif object.node?
      %span{:resource =&gt; get_curie(object), :rel =&gt; get_curie(predicate)}= get_curie(object)
    - elsif object.uri?
      %a{:href =&gt; object.to_s, :rel =&gt; get_curie(predicate)}= object.to_s
    - elsif object.datatype == RDF.XMLLiteral
      %span{:property =&gt; get_curie(predicate), :lang =&gt; get_lang(object), :datatype =&gt; get_dt_curie(object)}&lt;!= get_value(object)
    - else
      %span{:property =&gt; get_curie(predicate), :content =&gt; get_content(object), :lang =&gt; get_lang(object), :datatype =&gt; get_dt_curie(object)}&amp;= get_value(object)
</pre>

<p>In addition to <em>predicate</em> and <em>objects</em>, the template takes locals <em>property</em> and/or <em>rel</em>, which are
copies of <em>predicate</em> and indicate use in the @property or @rel attributes. Either or both may be
specified, as the conditions dictate.</p>

<p>Also, if the predicate is identified as a <em>heading predicate</em> (via <em>:heading_predicates</em> option),
it will generate a heading element, and may use the value as the document title.</p>

<p>Each <em>object</em> is yielded to the calling block, and the result is rendered, unless nil.
Otherwise, rendering depends on the type of <em>object</em>. This is useful for recursive document
descriptions.</p>

<p>Creates output similar to the following:</p>

<pre class="code">&lt;div class='property'&gt;
  &lt;span class='label'&gt;
    xhv:alternate
  &lt;/span&gt;
  &lt;a href='http://rdfa.info/feed/' rel='xhv:alternate'&gt;http://rdfa.info/feed/&lt;/a&gt;
&lt;/div&gt;
</pre>

<p>Note the use of methods defined in <span class='object_link'><a href="RDF/RDFa/Writer.html" title="RDF::RDFa::Writer (class)">RDF::RDFa::Writer</a></span> useful in rendering the output.</p></li>
<li><p><em>property_values</em>: Similar to <em>property_value</em>, but for predicates having more than one value.
Locals are identical to <em>property_values</em>, but <em>objects</em> is expected to have more than one value.</p>

<pre class="code">%div.property
  %span.label
    = get_predicate_name(predicate)
  %ul{:rel =&gt; (get_curie(rel) if rel), :property =&gt; (get_curie(property) if property)}
    - objects.each do |object|
      - if res = yield(object)
        != res
      - elsif object.node?
        %li{:resource =&gt; get_curie(object)}= get_curie(object)
      - elsif object.uri?
        %li
          %a{:href =&gt; object.to_s}= object.to_s
      - elsif object.datatype == RDF.XMLLiteral
        %li{:lang =&gt; get_lang(object), :datatype =&gt; get_curie(object.datatype)}&lt;!= get_value(object)
      - else
        %li{:content =&gt; get_content(object), :lang =&gt; get_lang(object), :datatype =&gt; get_dt_curie(object)}&amp;= get_value(object)
</pre>

<p>In this case, and unordered list is used for output. Creates output similar to the following:</p>

<pre class="code">&lt;div class='property'&gt;
  &lt;span class='label'&gt;
    xhv:bookmark
  &lt;/span&gt;
  &lt;ul rel='xhv:bookmark'&gt;
    &lt;li&gt;
      &lt;a href='http://rdfa.info/2009/12/12/oreilly-catalog-uses-rdfa/'&gt;
        http://rdfa.info/2009/12/12/oreilly-catalog-uses-rdfa/
      &lt;/a&gt;
    &lt;/li&gt;
      &lt;a href='http://rdfa.info/2010/05/31/new-rdfa-checker/'&gt;
        http://rdfa.info/2010/05/31/new-rdfa-checker/
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</pre>

<p>If <em>property_values</em> does not exist, repeated values will be replecated
using <em>property_value</em>.</p></li>
<li><p>Type-specific templates.
To simplify generation of different output types, the
template may contain a elements indexed by a URI. When a subject with an rdf:type
matching that URI is found, subsequent Haml definitions will be taken from
the associated Hash. For example:</p>

<p>  {
    :document => "...",
    :subject => "...",
    :property_value => "...",
    :property_values => "...",
    RDF::URI("http://schema.org/Person") => {
      :subject => "...",
      :property_value => "...",
      :property_values => "...",
    }
  }</p></li>
</ul>


<h2>Dependencies</h2>

<ul>
<li><a href="http://rubygems.org/gems/rdf">RDF.rb</a> (>= 0.3.1)</li>
<li><a href="http://rubygems.org/gems/nokogiri">Nokogiri</a> (>= 1.3.3)</li>
<li><a href="https://rubygems.org/gems/haml">Haml</a> (>= 3.0.0)</li>
</ul>


<h2>Documentation</h2>

<p>Full documentation available on <a href="http://rdf.rubyforge.org/rdfa">RubyForge</a></p>

<h3>Principle Classes</h3>

<ul>
<li><span class='object_link'><a href="RDF/RDFa/Format.html" title="RDF::RDFa::Format (class)">RDF::RDFa::Format</a></span>

<ul>
<li><span class='object_link'><a href="RDF/RDFa/HTML.html" title="RDF::RDFa::HTML (class)">RDF::RDFa::HTML</a></span>
Asserts :html format, text/html mime-type and .html file extension.</li>
<li><span class='object_link'><a href="RDF/RDFa/XHTML.html" title="RDF::RDFa::XHTML (class)">RDF::RDFa::XHTML</a></span>
Asserts :html format, application/xhtml+xml mime-type and .xhtml file extension.</li>
<li><span class='object_link'><a href="RDF/RDFa/SVG.html" title="RDF::RDFa::SVG (class)">RDF::RDFa::SVG</a></span>
Asserts :svg format, image/svg+xml mime-type and .svg file extension.</li>
</ul>
</li>
<li>RDF::RDFa::Reader</li>
<li><span class='object_link'><a href="RDF/RDFa/Profile.html" title="RDF::RDFa::Profile (class)">RDF::RDFa::Profile</a></span></li>
<li><span class='object_link'><a href="RDF/RDFa/Writer.html" title="RDF::RDFa::Writer (class)">RDF::RDFa::Writer</a></span></li>
</ul>


<h3>Additional vocabularies</h3>

<ul>
<li><span class='object_link'><a href="RDF/PTR.html" title="RDF::PTR (class)">RDF::PTR</a></span></li>
<li><span class='object_link'><a href="RDF/RDFA.html" title="RDF::RDFA (class)">RDF::RDFA</a></span></li>
<li><span class='object_link'><a href="RDF/XHV.html" title="RDF::XHV (class)">RDF::XHV</a></span></li>
<li><span class='object_link'><a href="RDF/XML.html" title="RDF::XML (class)">RDF::XML</a></span></li>
<li><span class='object_link'><a href="RDF/XSI.html" title="RDF::XSI (class)">RDF::XSI</a></span></li>
</ul>


<h2>TODO</h2>

<ul>
<li>Add support for LibXML and REXML bindings, and use the best available</li>
<li>Consider a SAX-based parser for improved performance</li>
</ul>


<h2>Resources</h2>

<ul>
<li><a href="http://rdf.rubyforge.org/">RDF.rb</a></li>
<li><a href="http://rdf.greggkellogg.net/distiller">Distiller</a></li>
<li><a href="http://rdf.rubyforge.org/rdfa">Documentation</a></li>
<li><a href="file:file.History.html">History</a></li>
<li><a href="http://www.w3.org/TR/2011/WD-rdfa-core-20110331/" title="RDFa 1.1 Core">RDFa 1.1 Core</a></li>
<li><a href="http://www.w3.org/TR/2011/WD-xhtml-rdfa-20110331/" title="XHTML+RDFa 1.1">XHTML+RDFa 1.1</a></li>
<li><a href="http://rdfa.digitalbazaar.com/test-suite/" title="RDFa test suite">RDFa-test-suite</a></li>
</ul>


<h2>Author</h2>

<ul>
<li><a href="http://github.com/gkellogg">Gregg Kellogg</a> - <a href="http://kellogg-assoc.com/">http://kellogg-assoc.com/</a></li>
</ul>


<h2>Contributors</h2>

<ul>
<li><a href="http://github.com/njh">Nicholas Humfrey</a></li>
</ul>


<h2>Contributing</h2>

<ul>
<li>Do your best to adhere to the existing coding conventions and idioms.</li>
<li>Don't use hard tabs, and don't leave trailing whitespace on any line.</li>
<li>Do document every method you add using <a href="http://yardoc.org/">YARD</a> annotations. Read the
<a href="http://rubydoc.info/docs/yard/file/docs/GettingStarted.md">tutorial</a> or just look at the existing code for examples.</li>
<li>Don't touch the <code>.gemspec</code>, <code>VERSION</code> or <code>AUTHORS</code> files. If you need to
change them, do so on your private branch only.</li>
<li>Do feel free to add yourself to the <code>CREDITS</code> file and the corresponding
list in the the <code>README</code>. Alphabetical order applies.</li>
<li>Do note that in order for us to merge any non-trivial changes (as a rule
of thumb, additions larger than about 15 lines of code), we need an
explicit <a href="http://lists.w3.org/Archives/Public/public-rdf-ruby/2010May/0013.html">public domain dedication</a> on record from you.</li>
</ul>


<h2>License</h2>

<p>This is free and unencumbered public domain software. For more information,
see <a href="http://unlicense.org/">http://unlicense.org/</a> or the accompanying <a href="file.UNLICENSE.html" title="UNLICENSE">UNLICENSE</a> file.</p>

<h2>FEEDBACK</h2>

<ul>
<li>gregg@kellogg-assoc.com</li>
<li><a href="http://rubygems.org/rdf-rdfa">http://rubygems.org/rdf-rdfa</a></li>
<li><a href="http://github.com/gkellogg/rdf-rdfa">http://github.com/gkellogg/rdf-rdfa</a></li>
<li><a href="http://lists.w3.org/Archives/Public/public-rdf-ruby/">http://lists.w3.org/Archives/Public/public-rdf-ruby/</a></li>
</ul>
</div></div>
    
    <div id="footer">
  Generated on Mon Aug 22 16:49:23 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>